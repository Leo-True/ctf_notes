# RSA基本原理

## 公钥与私钥的产生

1. 随机选择两个不同大质数 $p$ 和 $q$ ，计算 $N = p \times q$
2. 根据欧拉函数，求得 $\varphi (N) = \varphi (p)\varphi (q) = (p-1)(q-1)$
3. 选择一个小于 $\varphi (N)$ 的整数 $e$，使 $e$ 和 $\varphi (N)$ 互质。并求得 $e$ 关于 $\varphi (N)$ 的模反元素，命名为 $d$，有 $ed\equiv 1 \pmod {\varphi (N)}$
4. 将 $p$ 和 $q$ 的记录销毁

此时，$(N,e)$ 是公钥，$(N,d)$ 是私钥。

## 消息加密

首先需要将消息以一个双方约定好的方式转化为一个小于 $N$ 的整数 $m$ ，例如可以将每一个字转换为这个字的Unicode码。如果消息太长可以分段（块加密），然后对于每一部分利用如下公式加密，m 为明文，c 为密文：

$$
m^{e}\equiv c\pmod N
$$

## 消息解密

利用密钥 $d$ 进行解密，m 为明文，c 为密文：

$$
c^{d}\equiv m\pmod N
$$

## 常用术语

- **N** ：大整数，称之为 **模数**（**modulus**）
- **p** 和 **q** ：大整数N的两个 **因子**（**factor**）
- **e** 和 **d** ：互为模反的两个 **指数**（**exponent**）
- **m** 和 **c** ：**明文** 和 **密文**
- **(N, e)** 和 **(N, d)** ：**公钥** 和 **私钥**
