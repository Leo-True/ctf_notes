# 2023-8-4 电子取证练习答案

1. 目标对象张三收到上家李四给的一个word文件，内含关键信息。李四给的文件都是以5位数字作为密码。张三感觉不安全，把word文件又用winrar压缩了一次，对压缩包设置了复杂密码。但张三又怕密码太复杂了自己也记不住，所以他有个习惯，会把密码记在一个名为“password.txt”的文本文件里，然后把这个文本文件在计算机里找个目录藏起来。现在，那个有密码的压缩文件“重要.rar”就在电脑桌面上，**问：你能否找出记录压缩密码的文件“password.txt”，并一举突破word文件密码，把word文件里的信息读出来？**

    答：直接搜索文件 `password.txt`，可以用 `everything` 工具，搜起来更快。找到文件打开可见压缩密码 `abc123*#*668jkl` ，解压可得word文件 `note.docx`。已知该文件的密码只是 `5位数字` ，可以从 `00000 - 99999` 逐一尝试。可以用任何一个密码爆破软件来做。如果用电脑上的 `john the ripper`，则需要：

    1.1 生成字典：

    ```python
    with open('dictionary.txt', 'w') as f:
    for i in range(10000, 100000):
        f.write(str(i) + '\n')
    ```

    1.2 提取哈希：

    ```bash
    python office2john.py note.docx > hash.txt
    ```

    1.3 爆破密码：

    ```bash
    john --format=office --wordlist=dictionary.txt hash.txt
    ```

2. word文件里记录了他们用来交换信息的邮箱网址，张三很可能用电脑上的chrome浏览器上过这个网址，**问：你能否找出张三最近一次登录这个邮箱是什么时候？如果张三用浏览器保存邮箱登录密码的话，你能否把保存的登录密码找出来？**

    答：邮箱网址是 `https://account.proton.me/login` ，运行 `chrome` ，查看 `历史记录` ，可知张三最后一次登录时间是 `2023-8-4 00:55` 。查看 `密码管理工具` ，可见保存的密码为 `123zs**321` 。

3. 我们在电脑“图片”文件夹里发现了一张照片“room.jpg”，**问：你能否判断出这张照片拍摄于哪个城市？**

    答：查看图片属性，图片为手机拍摄，exif信息中没删除GPS经纬度坐标，根据经纬度可知照片拍摄于四川成都。

4. 我们在现场收缴到一批不同品牌型号的U盘。确定哪个U盘近期曾经在张三的电脑上使用过非常重要，问：你能否找出张三的电脑近期插入过的U盘品牌型号和序列号，以确定哪个U盘曾经在张三的电脑上使用过？

    答：需要对相关的事件日志进行分析。如果有取证工具会更便利，例如免费的 `USBDriveLog` 工具。运行即可见近期插入过的U盘品牌型号为 `Kingstone DataTraveler 200` ，序列号为 `0018F3D974BCBA4091400106` 。还可以看到U盘容量和每次插入、拔出的时间。

5. **张三是否使用过通信软件Signal（可能已经删除）？如果有，最后一次运行该软件的时间是什么时候？**

    答：需要对相关的事件日志进行分析。如果有取证工具会更便利，例如免费的 `UserAssistView` 工具。虽然Signal软件已被删除，`UserAssistView` 工具运行后查找 `Signal` ，仍可以发现Signal的运行记录，最后一次运行时间为 `2023-8-4 1:21` 。

6. **在 2023年8月2日 23:00-23:30 那段时间，张三的电脑是处于开机状态还是关机状态？**

    答：需要对相关的事件日志进行分析。如果有取证工具会更便利，例如免费的 `TurnedOnTimesView` 工具。运行即可见在张三的电脑从 `2023-8-2 22:52-23:54` 都处于开机状态，其中经历了几次重启。
